<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆæˆçº–ç¶­å°æŒ‘æˆ° Â· å·¥æ¥­èˆ‡ç¾ä»£ææ–™æ™‚ä»£</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', 'å¾®è»Ÿæ­£é»‘é«”', 'PingFang TC', Roboto, sans-serif;
            margin: 0;
            padding: 0;
        }
        body {
            min-height: 100vh;
            background: linear-gradient(145deg, #1b3b4f 0%, #2a5f7a 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 16px;
        }
        .game-panel {
            max-width: 750px;
            width: 100%;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(4px);
            border-radius: 48px 48px 32px 32px;
            box-shadow: 0 25px 40px -10px rgba(0, 20, 30, 0.6);
            overflow: hidden;
            border: 2px solid #f4e9d8;
            position: relative;
        }
        .game-header {
            background: #d8c5a8;
            padding: 24px 28px 18px 28px;
            border-bottom: 4px solid #b59a7a;
            text-align: center;
        }
        .game-header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            letter-spacing: 2px;
            color: #1e2f3b;
            text-shadow: 2px 2px 0 #e6d7bd;
            margin-bottom: 6px;
            word-break: break-word;
        }
        .game-header .sub {
            font-size: 1.2rem;
            font-weight: 500;
            color: #2d4b5a;
            background: #efe3d0;
            display: inline-block;
            padding: 6px 24px;
            border-radius: 40px;
            border: 1px solid #a48d70;
        }
        .quiz-area {
            padding: 30px 30px 25px;
            background: #fcf7ee;
            min-height: 550px;
            position: relative;
        }
        .status-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            font-weight: 600;
            color: #194353;
            background: #d9e2e8;
            padding: 10px 20px;
            border-radius: 60px;
            border: 1px solid #afc4cf;
        }
        .q-counter {
            background: #1b4b5e;
            color: #f2ffe6;
            padding: 6px 20px;
            border-radius: 40px;
            font-size: 1.1rem;
        }
        /* åˆ†æ•¸é¡¯ç¤ºå·²ç§»é™¤ */
        .score-badge {
            display: none;
        }
        .question-box {
            background: #ffffffc2;
            border-radius: 32px;
            padding: 20px 24px;
            box-shadow: inset 0 1px 5px #00000015, 0 10px 15px -10px #2f4f5e;
            border: 2px solid #cbae8b;
            margin-bottom: 30px;
            transition: opacity 0.3s;
        }
        .q-text {
            font-size: 1.7rem;
            font-weight: 700;
            color: #113946;
            line-height: 1.3;
            margin-bottom: 16px;
            word-break: break-word;
            border-left: 7px solid #328ba8;
            padding-left: 18px;
        }
        .hint-tag {
            font-size: 1rem;
            color: #755e3f;
            margin-bottom: 18px;
            background: #fff3d6;
            padding: 5px 15px;
            border-radius: 30px;
            display: inline-block;
            border: 1px solid #c9ab84;
            opacity: 0.8;
        }
        .options-grid {
            display: flex;
            flex-direction: column;
            gap: 14px;
            margin: 18px 0 12px;
        }
        .option-item {
            background: #f2e5d5;
            border-radius: 60px;
            border: 2px solid #b5926a;
            transition: 0.1s ease;
            font-size: 1.3rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            cursor: pointer;
            user-select: none;
            padding: 0;
            overflow: hidden;
        }
        .option-item:hover {
            background: #e3d1b9;
            border-color: #328ba8;
            transform: scale(1.01);
        }
        .option-item.selected {
            background: #b3d9e8;
            border-color: #1b6c8c;
            box-shadow: 0 0 0 3px #9ec3d8;
        }
        .option-prefix {
            background: #5d7f8f;
            color: white;
            font-weight: bold;
            min-width: 60px;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            border-right: 3px solid #284a5a;
            padding: 14px 0;
            align-self: stretch;
        }
        .option-label {
            padding: 14px 20px;
            flex: 1;
            text-align: left;
        }
        .feedback-area {
            min-height: 70px;
            margin: 20px 0 15px;
            font-size: 1.4rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
            background: #fff8e3;
            padding: 15px 22px;
            border-radius: 50px;
            border: 2px dashed #a48e75;
            transition: 0.2s;
        }
        .emoji-badge {
            font-size: 2.2rem;
            min-width: 50px;
            text-align: center;
        }
        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            justify-content: center;
            margin-top: 10px;
        }
        .game-btn {
            background: #e7d7bd;
            border: 3px solid #1b4f5e;
            color: #1b3a44;
            padding: 16px 28px;
            font-size: 1.4rem;
            font-weight: 700;
            border-radius: 50px;
            cursor: pointer;
            transition: 0.15s;
            box-shadow: 0 5px 0 #0f2e38;
            flex: 1 1 auto;
            min-width: 160px;
            letter-spacing: 1px;
        }
        .game-btn:active {
            transform: translateY(4px);
            box-shadow: 0 1px 0 #0f2e38;
        }
        .game-btn:disabled {
            opacity: 0.45;
            transform: translateY(2px);
            box-shadow: 0 3px 0 #0f2e38;
            pointer-events: none;
            filter: grayscale(0.3);
        }
        .game-btn.reset-btn {
            background: #cfdbe4;
            border-color: #2e5770;
            box-shadow: 0 5px 0 #1d3f4f;
            color: #083344;
        }
        .game-btn.next-btn {
            background: #c1d6d9;
            border-color: #266480;
            box-shadow: 0 5px 0 #124652;
            color: #05242f;
        }
        .footer-note {
            background: #d3c3aa;
            padding: 18px;
            text-align: center;
            font-weight: 500;
            color: #243b45;
            font-size: 1.2rem;
            border-top: 2px solid #a58d71;
            letter-spacing: 1px;
        }
        
        /* ç¥è³€ç•«é¢æ¨£å¼ */
        .celebration-container {
            text-align: center;
            padding: 30px 20px;
        }
        .celebration-emoji {
            font-size: 5rem;
            margin-bottom: 20px;
            animation: bounce 1s infinite alternate;
        }
        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-15px); }
        }
        .celebration-title {
            font-size: 2.5rem;
            font-weight: 800;
            color: #1e4a5f;
            margin-bottom: 15px;
            text-shadow: 2px 2px 0 #ffd966;
        }
        .celebration-message {
            font-size: 1.5rem;
            color: #2a5f7a;
            margin-bottom: 30px;
            font-weight: 600;
        }
        .celebration-reset-btn {
            background: #ffb347;
            border: 4px solid #b1440e;
            color: #3d1e00;
            padding: 18px 40px;
            font-size: 1.8rem;
            font-weight: 800;
            border-radius: 60px;
            cursor: pointer;
            box-shadow: 0 7px 0 #b1440e;
            transition: 0.1s;
            margin-top: 20px;
            display: inline-block;
        }
        .celebration-reset-btn:active {
            transform: translateY(5px);
            box-shadow: 0 2px 0 #b1440e;
        }
        .hidden {
            display: none;
        }
        
        /* å³ä¸‹è§’æˆå°±æç¤ºæ¨£å¼ - åŠ ä¸Š ğŸ… åœ–ç¤º */
        .achievement-toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(145deg, #f7e05e, #f9c74f);
            padding: 18px 25px;
            border-radius: 60px;
            box-shadow: 0 8px 0 #b86f2c, 0 10px 20px rgba(0,0,0,0.2);
            border: 3px solid #f9844a;
            z-index: 1000;
            transform: translateX(0);
            transition: opacity 0.5s, transform 0.3s;
            max-width: 380px;
            text-align: center;
        }
        .achievement-toast.fade-out {
            opacity: 0;
            transform: translateX(20px);
            pointer-events: none;
        }
        .toast-text {
            font-size: 1.6rem;
            font-weight: 800;
            color: #2d1508;
            line-height: 1.4;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        .toast-text .achievement-name {
            font-size: 1.9rem;
            font-weight: 900;
            color: #9d331f;
            background: #fff1b8;
            padding: 5px 18px;
            border-radius: 40px;
            border: 3px solid #b9582b;
            display: inline-block;
            margin-top: 5px;
        }
        @media (max-width: 500px) {
            .achievement-toast {
                bottom: 15px;
                right: 15px;
                padding: 12px 18px;
            }
            .toast-text {
                font-size: 1.3rem;
            }
            .toast-text .achievement-name {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="game-panel">
        <div class="game-header">
            <h1>åˆæˆçº–ç¶­å°æŒ‘æˆ°</h1>
            <div class="sub">å·¥æ¥­èˆ‡ç¾ä»£ææ–™æ™‚ä»£</div>
        </div>

        <div class="quiz-area" id="quizArea">
            <!-- ç‹€æ…‹åˆ—ï¼šåªä¿ç•™é¡Œè™Ÿ -->
            <div class="status-row">
                <span class="q-counter" id="questionCounter">Q1 / 3</span>
            </div>

            <!-- å•é¡Œå€å¡Š (æ­£å¸¸é¡¯ç¤º) -->
            <div class="question-box" id="questionContainer">
                <div class="q-text" id="questionText">1. åˆæˆçº–ç¶­æ˜¯å¾å“ªäº›åŸææ–™è£½æˆçš„ï¼Ÿ(å¯å¤šé¸)</div>
                <div class="hint-tag" id="answerHint">ğŸ‘‡ é»é¸é¸é …ï¼Œç„¶å¾ŒæŒ‰ä¸‹ã€Œæª¢æŸ¥ç­”æ¡ˆã€</div>
                
                <div class="options-grid" id="optionsContainer"></div>
                
                <!-- åé¥‹è¨Šæ¯å€ -->
                <div class="feedback-area" id="feedbackMessage">
                    <span class="emoji-badge" id="emojiBadge">ğŸ”</span>
                    <span id="feedbackText">é»æ“Šé¸é …ï¼Œç„¶å¾ŒæŒ‰ã€Œæª¢æŸ¥ç­”æ¡ˆã€</span>
                </div>

                <!-- ä¸‰å€‹æŒ‰éˆ• -->
                <div class="action-buttons">
                    <button class="game-btn" id="checkBtn">âœ… æª¢æŸ¥ç­”æ¡ˆ</button>
                    <button class="game-btn next-btn" id="nextBtn">â© ä¸‹ä¸€é¡Œ</button>
                    <button class="game-btn reset-btn" id="resetBtn">ğŸ”„ é‡æ–°é–‹å§‹</button>
                </div>
            </div>
            
            <!-- ç¥è³€ç•«é¢ (èˆ‡å•é¡Œå€å¡Šç›¸åŒä½ç½®ï¼Œåˆå§‹éš±è—) -->
            <div class="question-box hidden" id="celebrationContainer">
                <div class="celebration-container">
                    <div class="celebration-emoji">ğŸ‰ğŸ†âœ¨</div>
                    <div class="celebration-title">æ­å–œä½ ï¼</div>
                    <div class="celebration-message">ä½ å·²å®Œæˆæ‰€æœ‰é¡Œç›®ï¼</div>
                    <div class="celebration-reset-btn" id="celebrationResetBtn">ğŸ”„ å†ç©ä¸€æ¬¡</div>
                </div>
            </div>
            
            <!-- é å°¾ -->
            <div class="footer-note">
                å·¥æ¥­èˆ‡ç¾ä»£ææ–™æ™‚ä»£
            </div>
        </div>
    </div>
    
    <!-- å³ä¸‹è§’æˆå°±æç¤º - åŠ ä¸Š ğŸ… åœ–ç¤ºåœ¨æ–‡å­—å‰æ–¹ -->
    <div class="achievement-toast hidden" id="achievementToast">
        <div class="toast-text">
            ğŸ… è§£é–æˆå°±ï¼š<br>
            <span class="achievement-name">ã€åˆæˆçº–ç¶­å…¨åˆ¶éœ¸ã€‘</span>
        </div>
    </div>

    <script>
        (function() {
            // é¡Œåº« (é¸é …æ–‡å­—)
            const questions = [
                {   
                    text: "1. åˆæˆçº–ç¶­æ˜¯å¾å“ªäº›åŸææ–™è£½æˆçš„ï¼Ÿ(ç­”æ¡ˆå¯å¤šæ–¼ä¸€å€‹)",
                    options: ["è ¶çµ²", "æ£‰", "ç…¤", "ç¾Šæ¯›", "çŸ³æ²¹"],
                    correct: ["ç…¤", "çŸ³æ²¹"],
                    multiple: true,
                },
                {   
                    text: "2. ä»¥ä¸‹å“ªå€‹ä¸æ˜¯åˆæˆçº–ç¶­ç›¸æ¯”å¤©ç„¶çº–ç¶­çš„å¥½è™•ï¼Ÿ",
                    options: ["å¼·éŸŒæœ‰å½ˆæ€§", "é˜²æ±¡", "ä¸æ˜“ç€ç«", "ä¸æ˜“è¢«ç†±åŠ›æå£"],
                    correct: ["ä¸æ˜“è¢«ç†±åŠ›æå£"],
                    multiple: false,
                },
                {   
                    text: "3. ä»¥ä¸‹å“ªå€‹ç‰©ä»¶ä¸æ˜¯å°¼é¾çš„è£½æˆå“ï¼Ÿ",
                    options: ["é¢¨è¡£", "æ¯›è¡£", "èƒŒåŒ…", "å¸³ç¯·", "æ³³è¡£"],
                    correct: ["æ¯›è¡£"],
                    multiple: false,
                }
            ];

            const optionLetters = ["A", "B", "C", "D", "E"];

            // ç‹€æ…‹
            let currentIndex = 0;               
            let selected = [];                   // å„²å­˜é¸é …æ–‡å­—
            let answeredCorrectly = [false, false, false]; 
            
            // è¨˜éŒ„æ¯é¡Œæ˜¯å¦æ›¾ç¶“è¢«æ­£ç¢ºå›ç­”ï¼ˆç”¨æ–¼è§£é–ä¸‹ä¸€é¡Œï¼‰
            let questionUnlocked = [false, false, false];
            
            // æˆå°±æ˜¯å¦å·²é¡¯ç¤ºé (é¿å…é‡è¤‡å½ˆå‡º)
            let achievementShown = false;

            // DOM å…ƒç´ 
            const questionText = document.getElementById('questionText');
            const answerHint = document.getElementById('answerHint');
            const optionsContainer = document.getElementById('optionsContainer');
            const checkBtn = document.getElementById('checkBtn');
            const nextBtn = document.getElementById('nextBtn');
            const resetBtn = document.getElementById('resetBtn');
            const questionCounter = document.getElementById('questionCounter');
            const feedbackText = document.getElementById('feedbackText');
            const feedbackMsgDiv = document.getElementById('feedbackMessage');
            const emojiBadge = document.getElementById('emojiBadge');
            
            // ç¥è³€ç•«é¢ç›¸é—œå…ƒç´ 
            const questionContainer = document.getElementById('questionContainer');
            const celebrationContainer = document.getElementById('celebrationContainer');
            const celebrationResetBtn = document.getElementById('celebrationResetBtn');
            
            // å³ä¸‹è§’æˆå°±æç¤º
            const achievementToast = document.getElementById('achievementToast');

            // æ›´æ–°ä¸‹ä¸€é¡ŒæŒ‰éˆ•ç‹€æ…‹
            function updateNextButtonState() {
                nextBtn.disabled = !questionUnlocked[currentIndex];
            }

            // ç¹ªè£½é¸é …
            function renderOptions() {
                const q = questions[currentIndex];
                let htmlStr = '';
                q.options.forEach((optText, idx) => {
                    const letter = optionLetters[idx];
                    const isSelected = selected.includes(optText);
                    const selectedClass = isSelected ? 'selected' : '';
                    htmlStr += `
                        <div class="option-item ${selectedClass}" data-option="${optText}">
                            <span class="option-prefix">${letter}</span>
                            <span class="option-label">${optText}</span>
                        </div>
                    `;
                });
                optionsContainer.innerHTML = htmlStr;

                document.querySelectorAll('.option-item').forEach(optDiv => {
                    optDiv.addEventListener('click', (e) => {
                        const optionText = optDiv.dataset.option;
                        toggleSelection(optionText);
                    });
                });
            }

            // åˆ‡æ›é¸æ“‡ (ç¶­æŒä¸­æ€§æç¤º)
            function toggleSelection(optionText) {
                const q = questions[currentIndex];
                if (q.multiple) {
                    if (selected.includes(optionText)) {
                        selected = selected.filter(item => item !== optionText);
                    } else {
                        selected.push(optionText);
                    }
                    selected.sort(); 
                } else {
                    if (selected.length === 1 && selected[0] === optionText) {
                        selected = []; 
                    } else {
                        selected = [optionText]; 
                    }
                }
                renderOptions();
                setFeedback('è«‹é¸æ“‡ç­”æ¡ˆï¼Œç„¶å¾ŒæŒ‰ã€Œæª¢æŸ¥ç­”æ¡ˆã€', 'neutral', 'ğŸ”');
            }

            // è¨­å®š feedback è¨Šæ¯ + emoji
            function setFeedback(msg, type = 'neutral', emoji = 'ğŸ”') {
                feedbackText.innerText = msg;
                emojiBadge.innerText = emoji;
                
                if (type === 'success') {
                    feedbackMsgDiv.style.background = '#e2f7e2';
                    feedbackMsgDiv.style.border = '2px dashed #27843b';
                } else if (type === 'error') {
                    feedbackMsgDiv.style.background = '#ffe1de';
                    feedbackMsgDiv.style.border = '2px dashed #b7472a';
                } else if (type === 'warning') {
                    feedbackMsgDiv.style.background = '#fff3cd';
                    feedbackMsgDiv.style.border = '2px dashed #b58b3a';
                } else {
                    feedbackMsgDiv.style.background = '#fff8e3';
                    feedbackMsgDiv.style.border = '2px dashed #a48e75';
                }
            }

            // é¡¯ç¤ºå³ä¸‹è§’æˆå°±æç¤º (ç¾åœ¨å¸¶æœ‰ ğŸ… ç¬¦è™Ÿ)
            function showAchievementToast() {
                // é¡¯ç¤ºæˆå°±æç¤º
                achievementToast.classList.remove('hidden');
                achievementToast.classList.remove('fade-out');
                
                // 2.5ç§’å¾Œæ·¡å‡º
                setTimeout(() => {
                    achievementToast.classList.add('fade-out');
                    
                    setTimeout(() => {
                        // éš±è—æˆå°±æç¤º
                        achievementToast.classList.add('hidden');
                        achievementToast.classList.remove('fade-out');
                    }, 500);
                }, 2500);
            }

            // é¡¯ç¤ºç¥è³€ç•«é¢
            function showCelebration(show) {
                if (show) {
                    questionContainer.classList.add('hidden');
                    celebrationContainer.classList.remove('hidden');
                    // éš±è—é¡Œè™Ÿè¨ˆæ•¸å™¨
                    questionCounter.style.opacity = '0.5';
                } else {
                    questionContainer.classList.remove('hidden');
                    celebrationContainer.classList.add('hidden');
                    questionCounter.style.opacity = '1';
                }
            }

            // æª¢æŸ¥ç­”æ¡ˆ
            function checkAnswer() {
                // æœªä½œç­”æç¤ºï¼šå·¦å´åœ–ç¤ºç‚º âš ï¸ï¼Œæ–‡å­—ç‚ºã€Œè«‹å…ˆä½œç­”ã€‚ã€
                if (selected.length === 0) {
                    setFeedback('è«‹å…ˆä½œç­”ã€‚', 'warning', 'âš ï¸');
                    return;
                }

                const q = questions[currentIndex];
                const correctAnswers = q.correct;

                let isCorrect = false;
                if (selected.length === correctAnswers.length) {
                    const sortedSelected = [...selected].sort();
                    const sortedCorrect = [...correctAnswers].sort();
                    isCorrect = sortedSelected.every((val, i) => val === sortedCorrect[i]);
                }

                if (isCorrect) {
                    if (!questionUnlocked[currentIndex]) {
                        questionUnlocked[currentIndex] = true;
                    }
                    // æˆåŠŸè¨Šæ¯åªé¡¯ç¤ºã€Œæ­£ç¢ºï¼ã€
                    setFeedback('æ­£ç¢ºï¼', 'success', 'âœ…');
                } else {
                    setFeedback('ç­”æ¡ˆä¸æ­£ç¢ºï¼Œå†è©¦ä¸€æ¬¡å§', 'error', 'âŒ');
                }
                
                updateNextButtonState();
            }

            // è¼‰å…¥é¡Œç›®
            function loadQuestion(index) {
                // å…ˆç¢ºä¿ç¥è³€ç•«é¢éš±è—
                showCelebration(false);
                
                currentIndex = index;
                const q = questions[index];
                questionText.innerText = q.text;
                answerHint.innerText = `ç¬¬ ${index+1} é¡Œ / å…± 3 é¡Œ`;

                selected = [];
                renderOptions();

                questionCounter.innerText = `Q${index+1} / 3`;
                setFeedback('è«‹é¸æ“‡ç­”æ¡ˆï¼Œç„¶å¾ŒæŒ‰ã€Œæª¢æŸ¥ç­”æ¡ˆã€', 'neutral', 'ğŸ”');
                
                updateNextButtonState();
            }

            // ä¸‹ä¸€é¡Œ
            function nextQuestion() {
                if (!questionUnlocked[currentIndex]) {
                    setFeedback('âš ï¸ è«‹å…ˆæ­£ç¢ºå›ç­”æœ¬é¡Œ', 'warning', 'âš ï¸');
                    return;
                }
                
                // å¦‚æœç›®å‰æ˜¯æœ€å¾Œä¸€é¡Œï¼ˆç´¢å¼•2ï¼‰ï¼Œä¸”å·²è§£é–
                if (currentIndex === 2) {
                    // é¡¯ç¤ºæˆå°±æç¤º (å³ä¸‹è§’)
                    if (!achievementShown) {
                        achievementShown = true;
                        showAchievementToast();
                    }
                    
                    // ç›´æ¥é¡¯ç¤ºç¥è³€ç•«é¢
                    showCelebration(true);
                    return;
                }
                
                let newIndex = (currentIndex + 1) % questions.length;
                selected = [];
                loadQuestion(newIndex);
            }

            // é‡è¨­éŠæˆ²
            function resetGame() {
                currentIndex = 0;
                selected = [];
                questionUnlocked = [false, false, false];
                achievementShown = false; // é‡ç½®æˆå°±é¡¯ç¤ºç‹€æ…‹
                
                // ç¢ºä¿æˆå°±æç¤ºéš±è—
                achievementToast.classList.add('hidden');
                achievementToast.classList.remove('fade-out');
                
                showCelebration(false);
                loadQuestion(0);   
            }

            // ç¶å®šæŒ‰éˆ•
            checkBtn.addEventListener('click', checkAnswer);
            nextBtn.addEventListener('click', nextQuestion);
            resetBtn.addEventListener('click', resetGame);
            celebrationResetBtn.addEventListener('click', resetGame);

            // åˆå§‹åŒ–
            resetGame();
        })();
    </script>
</body>
</html>